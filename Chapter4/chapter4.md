# Layer Geometry

### Rounded Corners
- 레이어는 모서리 부분의 곡률을 제어하는 cornerRadius라는 속성을 갖고있다. 이는 해당 레이어에만 영향을 미치며, 하위 레이어들에는 영향을 미치지 않는다. 하지만 masksToBounds의
 속성이 true일 경우에는 해당 레이어의 크기를 벗어나는 하위 레이어의 영역 모든 부분은 둥근 모양으로 잘린다.

### Layer borders
- CALayer 속성에는 borderWidth, bordercolor라는 유용한 속성이 있다. 이는 레이어의 가장자리 주의에 그려지는 선을 위한 프로퍼티이며, 곡률을 포함하여 레이어의 경계를 따른다.
 테두리는 레이어 범위 내에서 그리고 하위 레이러르 ㄹ비롯한 다른 레이어 내용 앞에 그려진다.

### Drop Shadows
- 레이이간의 우선순위 혹은 순전히 외관상의 목적으로 상용되기도 한다. shadowOpacity 속성을 0보다 큰 값으로 설정하면 모든 레이어 뒤에 그림자가 표시 될 수 있다.
 (0 ~ 1사이의 부동 소수점 값을 가지며 1로 갈 수록 불투명해진다.) 그림자의 모양을 변경하려면 shadowColor, shadowOffset 및 shadowRadius와 같은 프로퍼티를 사용하면된다.
iOS에서 기본 그림자 효과는 위로 되어있는데 이는 CoreAnimation이 Layer Kit에서 변형되어 MacOS와 반대의 역 좌표계를 사용하기 때문이다.
  - shadowOffset에서 너비는 0으로 두고 높이만 조절해서 사용하는것이 좋다.
  - shadowradius 속성은 0이 아닌 값으로 지정하는것이 좋다.

### Shadow Clipping
- 레이어의 그림자는 bounds 및 cornerRadius 뿐 만 아니라 컨텐츠와 똑같은 모양도 가능하다. 하지만 레이어의 masksToBounds가 true일 경우 그림자도 잘리므로 주의해야한다.
- #### Shadow Path
  - 그림자의 모양이 무엇인지 알 고 있다면 CGPath로 그림자 모양을 지정할 수 있다.

### Layer Masking
- 32비트 PNG이미지를 사용하여 사각혀이 아닌 컨텐츠와 동일한 모양의 그림자를 만들 수 있지만 이는 이미지를 동적으로 클림할 수 없으며 동일한 임의 모양으로 자르기 위한 하위 뷰 혹은
하위 레이어가 필요하다. 이를 해결하기 위해 CALayer에는 mask라는 속성이 있다. mask 속성 자체는 CALayer이며, 부모 레이어 안쪽에 그려지는 대신, 마스크 레이어는 부모 레이어의
 보이지 않는 부분을 정의한다. 마스크 레이어의 중요한 것은 실루엣 뿐이다.

### Scaling Filters
- 일반적으로 iOS에서는 이미지를 표시할 때 올바른 크기로 표시해야한다.(이미지의픽셀과 화면의 픽셀 사이에 1:1 상관 관계가 있다.) 그 이유는
   - 픽셀이 늘어나거나 재 샘플링되지 않기 때문에 최상의 품질을 제공한다.
   - 필요 이상으로 많은 픽셀을 저장하지 않기 때문에 RAM을 최대한 활용한다.
   - GPU가 열심히 일할 필요가 없기 때문에 최상의 성능을 제공한다.
그러나 때로는 실제 크기보다 크거나 실제 크기보다 작은 이미지를 표시해야 할 수도 있다.이미지가 다른 크기로 표시되면 원본 이미지의 픽셀에 알고리즘
(스케일링 필터라고 함)이 적용되어 화면에 표시 될 새 픽셀을 생성합니다.
- CALayer는 이미지 크기를 조정할 때 세 가지 크기 조정 필터 중 하나를 선택할 수 있다.
   - kCAFilterLinear(기본 필터) : 쌍 선형 필터링 알고리즘 사용
   - kCAFilterTrilinear : 이미지를 여러 크기 (밉 매핑이라고도 함)에 저장 한 다음 3 차원으로 샘플링하고 크기가 더 큰 픽셀과 작은 픽셀을 결합하여 바이 리니어 필터링의 
   성능을 향상시킵니다.  방법의 장점은 알고리즘이 이미 최종 크기에 매우 가까운 한 쌍의 이미지에서 작동 할 수 있다는 것입니다. 즉, 동시에 많은 픽셀을 샘플링 할 필요가 
   없으므로 성능이 향상되고 반올림 오류로 인해 매우 작은 스케일 요소에서 발생할 수있는 샘플링 글리치를 피할 수 있습니다.
   - kCAFilterNearest : 가장 가까운 단일 픽셀을 샘플링하고 색상 혼합을 전혀 수행하지 않습니다. 이것은 매우 빠르며 이미지를 흐리게하지 않지만 축소 된 이미지의 
   경우 품질이 눈에 띄게 악화되고 확대 된 이미지가 고르지 않게 픽셀 화됩니다.

### Group Opacity
- UIView와 마찬가지로 CALayer에도 불투명도라는 동일한 속성이 있다. iOS의 일반적인 트릭은 알파를 0.5로 설정하요 사용 중지 된 것처럼 표시하는것이 있다. 이것은 개별 뷰의 경우
멋지게 작동하지만 하위 뷰가 있을 경우 하위 뷰에도 알파값이 먹는다. (그 이유는 픽셀 자체 색상 때문이다.) 즉 상위뷰 알파 0.5, 하위뷰 알파 0.5일 경우 하위뷰는 0.5+0.25 값이 먹는다.
CALayer의 shouldRasterize라는 속성을 이용하여 이를 해결할 수 있다.

### Summary
- 둥근 모서리, 그림자, 마스크, 스케일링 필터와 그룹 불투명도를 살펴보았다.